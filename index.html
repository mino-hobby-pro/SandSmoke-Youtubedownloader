<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ビデオ情報表示</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        #video-info {
            margin-top: 20px;
            border: 1px solid #ccc;
            padding: 10px;
        }
    </style>
</head>
<body>

<h1>ビデオ情報表示</h1>
<input type="text" id="videoId" placeholder="ビデオIDを入力" />
<button onclick="fetchVideoData()">ビデオ情報取得</button>

<div id="video-info"></div>

<script>
    const videoAPIs = [
        "https://invidious.jing.rocks/api/v1/videos/",
        "https://invidious.nerdvpn.de/api/v1/videos/",
        "https://script.google.com/macros/s/AKfycbxic9NV_JbKs1Ia4m5yw6z7nAZjkQ0mjZ2FGi29ZtLMhX9R6JSEO6jZBuXpNyWHCuRy/exec?videoId=",
        "https://script.google.com/macros/s/AKfycbzDTu2EJQrGPPU-YS3EFarXbfh9zGB1zR9ky-9AunHl7Yp3Gq83rh1726JYjxbjbEsB/exec?videoId=",
        "https://script.google.com/macros/s/AKfycbw43HTKJe0khOM3h5lrRbWw2OUONcbQCsnSry7F6c_1bPdtxVjTUotm1_XY2KfqMLWT/exec?videoId=",
        "https://script.google.com/macros/s/AKfycbxYjOWULjin5kpp-NcjjjGujVX3wy1TEJVUR2AZtR6-5c_q7GBr1Nctl2_Kat4lSboD/exec?videoId="
    ];

    async function fetchVideoData() {
        const videoId = document.getElementById('videoId').value;
        const videoInfoDiv = document.getElementById('video-info');
        videoInfoDiv.innerHTML = "読み込み中...";

        for (let api of videoAPIs) {
            try {
                const response = await fetch(api + encodeURIComponent(videoId));
                if (response.ok) {
                    const data = await response.json();
                    displayVideoData(data);
                    return;
                } else {
                    console.error(`エラー: ${response.status}`);
                }
            } catch (error) {
                console.error(`タイムアウト: ${api}`, error);
            }
        }

        videoInfoDiv.innerHTML = "ビデオ情報を取得できませんでした。";
    }

    function displayVideoData(data) {
        const videoInfoDiv = document.getElementById('video-info');
        videoInfoDiv.innerHTML = `
            <h2>${data.title}</h2>
            <p><strong>作者:</strong> ${data.author}</p>
            <p><strong>視聴回数:</strong> ${data.viewCount}</p>
            <p><strong>説明:</strong> ${data.descriptionHtml}</p>
            <p><strong>関連動画:</strong></p>
            <ul>
                ${data.recommendedVideos.map(video => `<li>${video.title} (ID: ${video.id})</li>`).join('')}
            </ul>
            <p><strong>ストリームURL:</strong></p>
            <ul>
                ${data.formatStreams.map(stream => `<li>${stream.url}</li>`).join('')}
            </ul>
        `;
    }
</script>

</body>
</html>
