<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>アクセスカウンター</title>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-app.js";
        import { getDatabase, ref, set, get, child } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-database.js";

        const firebaseConfig = {
            apiKey: "AIzaSyCFtCV9OP-oJqrzVaTqvuRkLD4GW2Hhhc0",
            authDomain: "sandsmoke-79dca.firebaseapp.com",
            databaseURL: "https://sandsmoke-79dca-default-rtdb.firebaseio.com",
            projectId: "sandsmoke-79dca",
            storageBucket: "sandsmoke-79dca.firebasestorage.app",
            messagingSenderId: "61141711489",
            appId: "1:61141711489:web:a1d074c6f9e6a3ecd26b80",
            measurementId: "G-C8FH5PFNEP"
        };

        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);

        const today = new Date().toISOString().split('T')[0]; // YYYY-MM-DD形式
        const counterRef = ref(database, `accessCount/${today}`);

        // アクセス数を1増やす
        function incrementAccessCount() {
            get(counterRef).then((snapshot) => {
                let currentCount = snapshot.exists() ? snapshot.val().count : 0;
                currentCount++;

                set(counterRef, { count: currentCount })
                    .then(() => {
                        console.log('アクセス数が更新されました:', currentCount);
                        displayAccessCount(currentCount);
                    })
                    .catch((error) => {
                        console.error('データの書き込みに失敗しました:', error);
                    });
            }).catch((error) => {
                console.error('データの取得に失敗しました:', error);
            });
        }

        // アクセス数を表示
        function displayAccessCount(count) {
            document.getElementById('accessCount').textContent = `今日のアクセス数: ${count}`;
        }

        // ページが読み込まれた際にアクセス数を増やす
        window.onload = incrementAccessCount;

    </script>
</head>
<body>
    <h1>アクセスカウンター</h1>
    <div id="accessCount">今日のアクセス数: 0</div>
</body>
</html>
